<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="triangle">
<title>Triangle Distribution Math • triangle</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Triangle Distribution Math">
<meta property="og:description" content="triangle">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">triangle</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/triangledistributionmath.html">Triangle Distribution Math</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bertcarnell/triangle/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Triangle Distribution Math</h1>
                        <h4 data-toc-skip class="author">Rob
Carnell</h4>
            
            <h4 data-toc-skip class="date">2024-02-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bertcarnell/triangle/blob/HEAD/vignettes/triangledistributionmath.Rmd" class="external-link"><code>vignettes/triangledistributionmath.Rmd</code></a></small>
      <div class="d-none name"><code>triangledistributionmath.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="triangle-notation">Triangle Notation<a class="anchor" aria-label="anchor" href="#triangle-notation"></a>
</h2>
<p><img src="triangledistributionmath_files/figure-html/triangle_drawing-1.png" width="480"></p>
<ul>
<li>
<span class="math inline">\(a\)</span> = minimum</li>
<li>
<span class="math inline">\(b\)</span> = maximum</li>
<li>
<span class="math inline">\(c\)</span> = mode</li>
<li>
<span class="math inline">\(h\)</span> = density at the mode = <span class="math inline">\(\frac{2}{b-a}\)</span>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="triangle-pdf">Triangle PDF<a class="anchor" aria-label="anchor" href="#triangle-pdf"></a>
</h2>
<p><span class="math display">\[f(x) =
\left\{
    \begin{array}{ll}
        \frac{h}{c-a}(x-a)  &amp; \mbox{if } a \leq x \leq c \\
        \frac{h}{c-b}(x-b) &amp; \mbox{if } c &lt; x \leq b \\
        0 &amp; \mbox{otherwise}
    \end{array}
\right.\ \ \ \ (1)\]</span></p>
<p>Integrating the pdf in equation (1) to solve for h</p>
<p><span class="math display">\[\int f(x) dx = 1\]</span></p>
<p><span class="math display">\[\frac{h}{c-a}\int_{a}^{c} (x-a) dx +
\frac{h}{c-b} \int_{c}^{b} (x-b) dx = \frac{h(b-a)}{2}\]</span></p>
<p><span class="math display">\[h=\frac{2}{b-a}\ \ \ \ (2)\]</span></p>
<p>Substituting back into equation (1),</p>
<p><span class="math display">\[f(x) =
\left\{
    \begin{array}{ll}
        \frac{2}{(b-a)(c-a)}(x-a)  &amp; \mbox{if } a \leq x \leq c \\
        \frac{2}{(b-a)(c-b)}(x-b) &amp; \mbox{if } c &lt; x \leq b \\
        0 &amp; \mbox{otherwise}
    \end{array}
\right.\ \ \ \ (3)\]</span></p>
</div>
<div class="section level2">
<h2 id="triangle-distribution-function">Triangle Distribution Function<a class="anchor" aria-label="anchor" href="#triangle-distribution-function"></a>
</h2>
<p><span class="math display">\[F_{x \le c}(x) =
\int_{-\infty}^{x}f(t)dt = \int_a^x \frac{2(t-a)}{(b-a)(c-a)}
dt\]</span></p>
<p><span class="math display">\[ =
\frac{(x-a)^2}{(b-a)(c-a)}\]</span></p>
<p><span class="math display">\[F_{x \gt c}(x) = 1 - \int_x^b
\frac{2(t-b)}{(b-a)(c-b)} dt\]</span> <span class="math display">\[ = 1
+ \frac{(x - b)^2}{(b-a)(c-b)}\]</span></p>
</div>
<div class="section level2">
<h2 id="triangle-mean">Triangle Mean<a class="anchor" aria-label="anchor" href="#triangle-mean"></a>
</h2>
<p>Integrating equation (3) to find <span class="math inline">\(E(x)\)</span>,</p>
<p><span class="math display">\[
\begin{align}
E(X) &amp;= \int xf(x)dx = \frac{2}{(b-a)(c-a)}\int_a^c (x^2-ax) dx +
\frac{2}{(b-a)(c-b)}\int_c^b (x^2-bx) dx \\
&amp;= \frac{a+b+c}{3}\ \ \ \ (4)
\end{align}
\]</span></p>
</div>
<div class="section level2">
<h2 id="triangle-variance">Triangle Variance<a class="anchor" aria-label="anchor" href="#triangle-variance"></a>
</h2>
<p><span class="math display">\[
\begin{align}
V(X) &amp;= E(X^2) - \big(E(X)\big)^2 = \int x^2f(x)dx-
\bigg(\frac{a+b+c}{3}\bigg)^2 \\
&amp;= \frac{2}{(b-a)(c-a)}\int_{a}^{c} x^2(x-a) dx +
\frac{2}{(b-a)(c-b)} \int_{c}^{b} x^2(x-b) dx-
\bigg(\frac{a+b+c}{3}\bigg)^2 \\
&amp;= \frac{a^2+b^2+c^2-ab-ac-bc}{18}
\end{align}
\]</span></p>
</div>
<div class="section level2">
<h2 id="logarithmic-triangle-distribution">Logarithmic Triangle distribution<a class="anchor" aria-label="anchor" href="#logarithmic-triangle-distribution"></a>
</h2>
<p>Define:</p>
<p><span class="math display">\[a_l=\log_{\phi}(a),\ \
b_l=\log_{\phi}(b),\ \ c_l=\log_{\phi}(c),\ \ h=\frac{2}{b_l-a_l}, \ \
\phi = \mbox{log base}\]</span></p>
<p><span class="math display">\[f(z) =
\left\{
  \begin{array}{ll}
    \frac{h}{c_l - a_l}(z - a_l) &amp; \mbox{if } a_l \leq z \leq c_l \\
    \frac{h}{c_l - b_l}(z - b_l) &amp; \mbox{if } c_l &lt; z \leq b_l \\
    0 &amp; \mbox{otherwise}
  \end{array}
\right.\ \ \ \ (5)\]</span></p>
<p>However,</p>
<p><span class="math display">\[E({\phi}^z) \neq {\phi}^{E(z)}\ \ \ \
(6)\]</span></p>
<p>Therefore, transforming…</p>
<p><span class="math display">\[Y={\phi}^Z\]</span></p>
<p><span class="math display">\[Z=\log_{\phi}(Y)\]</span></p>
<p><span class="math display">\[w(y)=\log_{\phi}(y)\]</span></p>
<p><span class="math display">\[w'(y)=\frac{dz}{dy} =
\frac{1}{y\log({\phi})}\]</span></p>
<p><span class="math display">\[g(y)=f(w(y))w'(y)\]</span></p>
<p><span class="math display">\[g(y) =
\left\{
  \begin{array}{ll}
    \frac{2}{(c_l-a_l)(b_l-a_l)\log({\phi})}\frac{log_{\phi}(y) -
a_l}{y} &amp; \mbox{if } 0 &lt; a \leq y \leq c \\
    \frac{2}{(c_l-b_l)(b_l-a_l)\log({\phi})}\frac{log_{\phi}(y) -
b_l}{y} &amp; \mbox{if } c &lt; y \leq b \\
    0 &amp; \mbox{otherwise}
  \end{array}
\right.\ \ \ \ (7)\]</span></p>
<p>Define:</p>
<p><span class="math display">\[\beta_1=\frac{2}{(c_l-a_l)(b_l-a_l)}\]</span></p>
<p><span class="math display">\[\beta_2=\frac{2}{(c_l-b_l)(b_l-a_l)}\]</span></p>
<p>Finding the CDF,</p>
<p><span class="math display">\[G(y) = \int_{-\infty}^y
g(y)dy\]</span></p>
<p><span class="math display">\[
\begin{align}
\mbox{for}\ a \leq y \leq c,\ \ G(y) &amp;= \frac{\beta_1}{\log({\phi})}
\int_a^y \frac{\log(y)}{y\log({\phi})}-\frac{a_l}{y}dy \\
&amp;=\beta_1 \bigg[\frac{\log_{\phi}^2(y)}{2} - a_l \log_{\phi}(y) -
\frac{a_l^2}{2} + a_l^2\bigg]
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
\mbox{for}\ c &lt; y \leq b,\ \ G(y) &amp;= G(c) +
\frac{\beta_2}{\log({\phi})} \int_c^y \frac{\log(y)}{y\log({\phi})} -
\frac{b_l}{y}dy \\
&amp;=G(c) + \beta_2 \bigg[\frac{\log_{\phi}^2(y)}{2} - b_l
\log_{\phi}(y) - \frac{c_l^2}{2} + b_l c_l\bigg]
\end{align}
\]</span></p>
<p>Checking that the CDF is 1 at b,</p>
<p><span class="math display">\[
\begin{align}
G(b) &amp;= \frac{c_l^2 - 2a_l c_l + a_l^2}{(c_l-a_l)(b_l-a_l)} +
\frac{-b_l^2-c_l^2+2b_lc_l}{(c_l-b_l)(b_l-a_l)} \\
&amp;= \frac{c_l-a_l}{b_l-a_l} + \frac{-(c_l-b_l)}{b_l-a_l} = 1
\end{align}
\]</span></p>
<p>Now calculating <span class="math inline">\(E(y)\)</span>,</p>
<p><span class="math display">\[
\begin{align}
E(y) &amp;= \int y\ g(y)\ dy \\
&amp;=\frac{\beta_1}{\log({\phi})} \int_a^c
\bigg[\frac{\log(y)}{\log({\phi})} - a_l\bigg]dy +
\frac{\beta_2}{\log({\phi})} \int_c^b \bigg[\frac{\log(y)}{\log({\phi})}
- b_l\bigg]dy \\
&amp;=\frac{c\beta_1}{\log^2({\phi})} \bigg[\log(c) - 1 - \log(a) +
\frac{a}{c} \bigg] + \frac{c\beta_2}{\log^2({\phi})} \bigg[\frac{-b}{c}
- \log(c) + 1 + \log(b) \bigg]
\end{align}
\]</span></p>
</div>
<div class="section level2">
<h2 id="method-of-moments-estimation">Method of Moments Estimation<a class="anchor" aria-label="anchor" href="#method-of-moments-estimation"></a>
</h2>
<p><span class="math display">\[E(x) = \frac{a + b + c}{3}\]</span></p>
<p><span class="math display">\[c = 3E(x) - a - b\]</span></p>
<p><span class="math display">\[\hat{a} = min(x)\]</span></p>
<p><span class="math display">\[\hat{b} = max(x)\]</span></p>
<p><span class="math display">\[\hat{c} = 3\bar{x} - \min(x) -
\max(x)\]</span></p>
</div>
<div class="section level2">
<h2 id="maximum-likelihood-estimation">Maximum Likelihood Estimation<a class="anchor" aria-label="anchor" href="#maximum-likelihood-estimation"></a>
</h2>
<p>The procedure for maximum likelihood estimation involves maximizing
the likelihood with respect to <span class="math inline">\(c\)</span>
for a fixed <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, followed by minimizing the negative
log likelihood with respect to <span class="math inline">\(a\)</span>
and <span class="math inline">\(b\)</span> for a fixed <span class="math inline">\(c\)</span>.</p>
<div class="section level3">
<h3 id="maximizing-the-likelihood-with-respect-to-c">Maximizing the Likelihood with respect to <span class="math inline">\(c\)</span><a class="anchor" aria-label="anchor" href="#maximizing-the-likelihood-with-respect-to-c"></a>
</h3>
<p>This discussion follows the results from <a href="https://doi.org/10.1142/5720" class="external-link">Samuel Kotz and Johan Rene van Dorp.
Beyond Beta</a></p>
<p>For the purposes of this section, with a fixed <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, the sample can be easily rescaled to
<span class="math inline">\(a=0\)</span> and <span class="math inline">\(b=1\)</span>. This section will proceed on <span class="math inline">\([0,1]\)</span> with the mode at <span class="math inline">\(0 \le c \le 1\)</span></p>
<p><span class="math display">\[w(x) =
\left\{
  \begin{array}{ll}
    \frac{2x}{c} &amp; \mbox{if } 0 \le x \lt c \\
    \frac{2(1-x)}{1-c} &amp; \mbox{if } c \le x \leq 1 \\
    0 &amp; \mbox{otherwise}
  \end{array}
\right.\]</span></p>
<p><span class="math display">\[L(x|c) = \prod_{i}^{n}
w(x|c)\]</span></p>
<p>Assume that the sample is ordered into order statistics <span class="math inline">\(X_{(1)} \lt \dots \lt X_{(n)}\)</span>. Also, note
that <span class="math inline">\(X_{(r)} \le c \lt X_{(r+1)}\)</span>.
In other words, the mode falls between the <span class="math inline">\(r^{th}\)</span> and <span class="math inline">\(r+1\)</span> order statistics.</p>
<p><span class="math display">\[L(x|c) = \prod_{i=1}^{r}
\frac{2x_{(i)}}{c} \prod_{i=r+1}^{n} \frac{2(1-x_{(i)})}{1-c} =
\frac{2^n \prod_{i=1}^{r} x_{(i)} \prod_{i=r+1}^{n}
(1-x_{(i)})}{c^r(1-c)^{n-r}}\]</span></p>
<p>To maximize the likelihood, we can first maximize with respect to
<span class="math inline">\(r\)</span> and then locate <span class="math inline">\(c\)</span> between the <span class="math inline">\(r^{th}\)</span> and <span class="math inline">\(r+1\)</span> order statistics. For notation
purposes, also define <span class="math inline">\(X_{(0)} = 0\)</span>
and <span class="math inline">\(X_{(n+1)} = 1\)</span>.</p>
<p><span class="math display">\[\large \max_{0 \le c \le 1} L(x|c) =
\max_{r \ \epsilon \ (0,\dots,n)} \ \ \max_{x_{(r)} \le c \le x_{(r+1)}}
\ \ L(x|c)\]</span></p>
<div class="section level4">
<h4 id="case-1-c-is-between-the-first-and-second-to-last-order-statistic-r-epsilon-1-dots-n-1">Case 1: <span class="math inline">\(c\)</span> is between the first
and second to last order statistic <span class="math inline">\(r \
\epsilon \ (1, \dots, n-1)\)</span><a class="anchor" aria-label="anchor" href="#case-1-c-is-between-the-first-and-second-to-last-order-statistic-r-epsilon-1-dots-n-1"></a>
</h4>
<p>Noticing that maximizing the likelihood is equivalent to minimizing
the denominator:</p>
<p><span class="math display">\[\large \max L(x|c) = \max_{r \ \epsilon
\ (1,\dots,n-1)} \ \ \min_{x_{(r)} \le c \le x_{(r+1)}} \ \
c^r(1-c)^{n-r}\]</span></p>
<p>Since <span class="math inline">\(c^r(1-c)^{n-r}\)</span> is unimodal
with respect to <span class="math inline">\(c\)</span>, it should be
sufficient to test the end points of an interval to find the minimum on
the interval</p>
<p><span class="math display">\[\large = \max_{r \ \epsilon \
(1,\dots,n-1)} \ \ \min_{c \ \epsilon \ (x_{(r)},\ \ x_{(r+1)})} \ \
c^r(1-c)^{n-r}\]</span></p>
<p>Therefore, for this case, it is sufficient to test the likelihood
using <span class="math inline">\(c\)</span> at each of the sampled
points and find the largest.</p>
<div class="section level5">
<h5 id="side-note-on-zcr1-cn-r-being-unimodal">Side note on <span class="math inline">\(z=c^r(1-c)^{n-r}\)</span>
being unimodal<a class="anchor" aria-label="anchor" href="#side-note-on-zcr1-cn-r-being-unimodal"></a>
</h5>
<p><span class="math display">\[\frac{dz}{dc} = rc^{(r-1)}(1-c)^{n-r} +
c^r(n-r)(1-c)^{n-r-1}(-1) = c^{(r-1)}(1-c)^{n-r-1}(r - cn)\]</span></p>
<p><span class="math inline">\(\frac{dz}{dc} = 0\)</span> at <span class="math inline">\(c=0,\ 1,\ \frac{r}{n}\)</span>. At <span class="math inline">\(0 &lt; c &lt; \frac{r}{n}\)</span>, <span class="math inline">\(z\)</span> is positive, and at <span class="math inline">\(\frac{r}{n} &lt; c &lt; 1\)</span>, <span class="math inline">\(z\)</span> is negative. Therefore, <span class="math inline">\(z\)</span> is unimodal on <span class="math inline">\((0,1)\)</span>.</p>
</div>
</div>
<div class="section level4">
<h4 id="case-2-c-is-between-0-and-the-first-order-statistic-r-0">Case 2: <span class="math inline">\(c\)</span> is between 0 and the
first order statistic <span class="math inline">\(r = 0\)</span><a class="anchor" aria-label="anchor" href="#case-2-c-is-between-0-and-the-first-order-statistic-r-0"></a>
</h4>
<p><span class="math display">\[\large \max L(x|c) = \max_{0 \le c \le
x_{(1)}} \prod_{i=1}^{n} \frac{1-x_{(i)}}{1-c} = \prod_{i=1}^{n}
\frac{1-x_{(i)}}{1-x_{(1)}}\]</span></p>
<p>Choosing the largest endpoint in the interval, creates the smallest
denominator, and the largest likelihood.</p>
<p>Therefore, for this case, it is sufficient to test the likelihood
using <span class="math inline">\(c\)</span> at the first sampled
point.</p>
</div>
<div class="section level4">
<h4 id="case-3-c-is-between-the-last-order-statistic-r-n-and-1">Case 3: <span class="math inline">\(c\)</span> is between the last
order statistic <span class="math inline">\(r = n\)</span> and 1<a class="anchor" aria-label="anchor" href="#case-3-c-is-between-the-last-order-statistic-r-n-and-1"></a>
</h4>
<p><span class="math display">\[\large \max L(x|c) = \max_{x_{(n)} \le c
\le 1} \prod_{i=1}^{n} \frac{x_{(i)}}{c} = \prod_{i=1}^{n}
\frac{x_{(i)}}{x_{(n)}}\]</span></p>
<p>Choosing the smallest option in the denominator creates the largest
likelihood. Again, it is sufficient to test the likelihood using <span class="math inline">\(c\)</span> at the largest sample point.</p>
</div>
<div class="section level4">
<h4 id="all-cases">All Cases<a class="anchor" aria-label="anchor" href="#all-cases"></a>
</h4>
<p>For all cases, it is sufficient to compute the sample likelihood
using <span class="math inline">\(c\)</span> equal to each of the
samples, and choosing the largest likelihood from the <span class="math inline">\(n\)</span> options to find the corresponding <span class="math inline">\(c\)</span>. This calculation is performed with a
fixed <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, so the test must be performed
iteratively as <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are separately optimized.</p>
</div>
</div>
<div class="section level3">
<h3 id="negative-log-likelihood">Negative Log Likelihood<a class="anchor" aria-label="anchor" href="#negative-log-likelihood"></a>
</h3>
<p><span class="math display">\[
\begin{align}
nLL &amp;= -\log(L) = -\log\left(\prod_i^n f(x_i)\right) \\
&amp;= - \sum_i^n \log\left(f(x_i)\right) = - \sum_{i: \ a \le x_i \lt
c}^{n_1}  \log\left(f(x_i)\right) - \sum_{i: \ c \le x_i \le b}^{n_2}
\log\left(f(x_i)\right)
\end{align}
\]</span></p>
<p>where <span class="math inline">\(n = n_1 + n_2\)</span></p>
<div class="section level4">
<h4 id="case-1-a-c-lt-b">Case 1: <span class="math inline">\(a = c \lt b\)</span><a class="anchor" aria-label="anchor" href="#case-1-a-c-lt-b"></a>
</h4>
<p><span class="math display">\[
\begin{align}
nLL &amp;= - \sum_{i}^{n} \log(2) + \log(b-x_i) - \log(b-a) - \log(b-c)
\\
&amp;= -n\log(2) + n\log(b-a) + n \log(b-c) - \sum_{i}^{n} \log(b-x_i)
\end{align}
\]</span></p>
</div>
<div class="section level4">
<h4 id="case-2-a-lt-c-b">Case 2: <span class="math inline">\(a \lt c = b\)</span><a class="anchor" aria-label="anchor" href="#case-2-a-lt-c-b"></a>
</h4>
<p><span class="math display">\[
\begin{align}
nLL &amp;= - \sum_{i}^{n} \log(2) + \log(x_i - a) - \log(b-a) -
\log(c-a) \\
&amp;= -n\log(2) + n\log(b-a) + n\log(c-a) - \sum_{i}^{n} \log(x_i - a)
\end{align}
\]</span></p>
</div>
<div class="section level4">
<h4 id="case-3-a-lt-c-lt-b">Case 3: <span class="math inline">\(a \lt c \lt b\)</span><a class="anchor" aria-label="anchor" href="#case-3-a-lt-c-lt-b"></a>
</h4>
<p><span class="math display">\[
\begin{align}
nLL &amp;= - \sum_{i: \ a \lt x_i \lt c}^{n_1} \log(2) + \log(x_i - a) -
\log(b-a) - \log(c-a) - \sum_{i: \ c \le x_i \lt b}^{n_2} \log(2) +
\log(b-x_i) - \log(b-a) - \log(b-c) \\
&amp;= -n\log(2) + n\log(b-a) + n_1\log(c-a) + n_2 \log(b-c) - \sum_{i:
\ a \lt x_i \lt c}^{n_1} \log(x_i - a) - \sum_{i: \ c \le x_i \lt
b}^{n_2} \log(b-x_i)
\end{align}
\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="gradient-of-the-negative-log-likelihood-given-c">Gradient of the negative Log Likelihood Given <span class="math inline">\(c\)</span>:<a class="anchor" aria-label="anchor" href="#gradient-of-the-negative-log-likelihood-given-c"></a>
</h3>
<p>The negative log likelihood is not differentiable with respect to
<span class="math inline">\(c\)</span> because the limits of the sum
(<span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span>) are functions of <span class="math inline">\(c\)</span>. Therefore the gradient and hessian are
derived as if <span class="math inline">\(c\)</span> is fixed.</p>
<div class="section level4">
<h4 id="case-1-a-c-lt-b-1">Case 1: <span class="math inline">\(a = c \lt b\)</span><a class="anchor" aria-label="anchor" href="#case-1-a-c-lt-b-1"></a>
</h4>
<p><span class="math display">\[\frac{\partial nLL}{\partial a} = -
\frac{n}{b-a}\]</span></p>
<p><span class="math display">\[\frac{\partial nLL}{\partial b} =
\frac{n}{b-a} + \frac{n}{b-c} - \sum_i^{n} \frac{1}{b-x_i}\]</span></p>
</div>
<div class="section level4">
<h4 id="case-2-a-lt-c-b-1">Case 2: <span class="math inline">\(a \lt c = b\)</span><a class="anchor" aria-label="anchor" href="#case-2-a-lt-c-b-1"></a>
</h4>
<p><span class="math display">\[\frac{\partial nLL}{\partial a} = -
\frac{n}{b-a} - \frac{n}{c-a} + \sum_i^{n} \frac{1}{x_i -
a}\]</span></p>
<p><span class="math display">\[\frac{\partial nLL}{\partial b} =
\frac{n}{b-a}\]</span></p>
</div>
<div class="section level4">
<h4 id="case-3-a-lt-c-lt-b-1">Case 3: <span class="math inline">\(a \lt c \lt b\)</span><a class="anchor" aria-label="anchor" href="#case-3-a-lt-c-lt-b-1"></a>
</h4>
<p><span class="math display">\[\frac{\partial nLL}{\partial a} = -
\frac{n}{b-a} - \frac{n_1}{c-a} + \sum_i^{n_1} \frac{1}{x_i -
a}\]</span></p>
<p><span class="math display">\[\frac{\partial nLL}{\partial b} =
\frac{n}{b-a} + \frac{n_2}{b-c} - \sum_i^{n_2}
\frac{1}{b-x_i}\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="hessian-of-the-negative-log-likelihood-given-c">Hessian of the negative Log Likelihood Given <span class="math inline">\(c\)</span>:<a class="anchor" aria-label="anchor" href="#hessian-of-the-negative-log-likelihood-given-c"></a>
</h3>
<div class="section level4">
<h4 id="case-1-a-c-lt-b-2">Case 1: <span class="math inline">\(a = c \lt b\)</span><a class="anchor" aria-label="anchor" href="#case-1-a-c-lt-b-2"></a>
</h4>
<p><span class="math display">\[\frac{\partial^2nLL}{\partial a^2} = -
\frac{n}{(b-a)^2}\]</span></p>
<p><span class="math display">\[\frac{\partial^2 nLL}{\partial b^2} =
-\frac{n}{(b-a)^2} - \frac{n}{(b-c)^2} + \sum_i^{n}
\frac{1}{(b-x_i)^2}\]</span></p>
<p><span class="math display">\[\frac{\partial^2 nLL}{\partial a\partial
b} = \frac{\partial^2 nLL}{\partial b\partial a} = -
\frac{n}{(b-a)^2}\]</span></p>
</div>
<div class="section level4">
<h4 id="case-2-a-lt-c-b-2">Case 2: <span class="math inline">\(a \lt c = b\)</span><a class="anchor" aria-label="anchor" href="#case-2-a-lt-c-b-2"></a>
</h4>
<p><span class="math display">\[\frac{\partial^2 nLL}{\partial a^2} = -
\frac{n}{(b-a)^2} - \frac{n}{(c-a)^2} + \sum_i^{n} \frac{1}{(x_i -
a)^2}\]</span></p>
<p><span class="math display">\[\frac{\partial^2 nLL}{\partial b^2} = -
\frac{n}{(b-a)^2}\]</span></p>
<p><span class="math display">\[\frac{\partial^2 nLL}{\partial a\partial
b} = \frac{\partial^2 nLL}{\partial b\partial a} = -
\frac{n}{(b-a)^2}\]</span></p>
</div>
<div class="section level4">
<h4 id="case-3-a-lt-c-lt-b-2">Case 3: <span class="math inline">\(a \lt c \lt b\)</span><a class="anchor" aria-label="anchor" href="#case-3-a-lt-c-lt-b-2"></a>
</h4>
<p><span class="math display">\[\frac{\partial^2 nLL}{\partial a^2} = -
\frac{n}{(b-a)^2} - \frac{n_1}{(c-a)^2} + \sum_i^{n_1} \frac{1}{(x_i -
a)^2}\]</span></p>
<p><span class="math display">\[\frac{\partial ^2 nLL}{\partial b^2} =
-\frac{n}{(b-a)^2} - \frac{n_2}{(b-c)^2} + \sum_i^{n_2}
\frac{1}{(b-x_i)^2}\]</span></p>
<p><span class="math display">\[\frac{\partial ^2 nLL}{\partial
a\partial b} = \frac{\partial ^2 nLL}{\partial b\partial a} = -
\frac{n}{(b-a)^2}\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="mle-variance---covariance">MLE Variance - Covariance<a class="anchor" aria-label="anchor" href="#mle-variance---covariance"></a>
</h3>
<p>For the optimization of <span class="math inline">\((a,b)\)</span>
given <span class="math inline">\(c\)</span>, we can use the inverse of
the hessian of the negative log likelihood for an estimate of the
covariance matrix of <span class="math inline">\(\hat{a}\)</span> and
<span class="math inline">\(\hat{b}\)</span>. For the variance in <span class="math inline">\(\hat{c}\)</span>, we use the variance of the <span class="math inline">\(r^{th}\)</span> order statistic which corresponds
to <span class="math inline">\(c\)</span>. The covariance of <span class="math inline">\((a,b)\)</span> and <span class="math inline">\(c\)</span> is not computed because the negative
log likelihood is not differentiable with respect to <span class="math inline">\(c\)</span>.</p>
<p>Let <span class="math inline">\(H\)</span> denote the Hessian matrix,
and let <span class="math inline">\(H^{-1}[1,1]\)</span> be the <span class="math inline">\(V(\hat{a})\)</span>, <span class="math inline">\(H^{-1}[2,2]\)</span> be the <span class="math inline">\(V(\hat{b})\)</span>, and <span class="math inline">\(H^{-1}[1,2] = H^{-1}[2,1]\)</span> be the <span class="math inline">\(Cov(\hat{a}, \hat{b})\)</span>. Then,</p>
<p><span class="math display">\[ V([\hat{a}, \hat{b}, \hat{c}]) =   
\begin{bmatrix}
   H^{-1}[1,1] &amp; H^{-1}[1,2] &amp; 0  \\
   H^{-1}[2,1] &amp; H^{-1}[2,2] &amp; 0  \\
   0 &amp; 0 &amp; V(\hat{c})  \\
\end{bmatrix}
\]</span></p>
<div class="section level4">
<h4 id="rth-order-statistic">
<span class="math inline">\(r^{th}\)</span> order statistic<a class="anchor" aria-label="anchor" href="#rth-order-statistic"></a>
</h4>
<p><span class="math display">\[f(x_{(r)}) = r {n \choose r} f(x)
[F(x)]^{r-1}[1-F(x)]^{n-r}\]</span></p>
</div>
<div class="section level4">
<h4 id="expected-value-of-the-rth-order-statistic">Expected value of the <span class="math inline">\(r^{th}\)</span>
order statistic<a class="anchor" aria-label="anchor" href="#expected-value-of-the-rth-order-statistic"></a>
</h4>
<p><span class="math display">\[
\begin{align}
E(X_{(r)}) &amp;= \int x f(x_{(r)}) dx \\
&amp;= \int_a^c xr {n \choose r} \frac{2(x-a)}{(b-a)(c-a)}
\left(\frac{(x-a)^2}{(b-a)(c-a)}\right)^{r-1}\left(1 -
\frac{(x-a)^2}{(b-a)(c-a)}\right)^{n-r}dx \\
&amp;+ \int_c^b xr {n \choose r} \frac{2(x-b)}{(b-a)(c-b)}
\left(1+\frac{(x-b)^2}{(b-a)(c-b)}\right)^{r-1}\left(-
\frac{(x-b)^2}{(b-a)(c-b)}\right)^{n-r}dx
\end{align}
\]</span></p>
<p>To simplify the notation, define:</p>
<p><span class="math display">\[\gamma_0 = 2r {n \choose r}\]</span></p>
<p><span class="math display">\[\gamma_1 = (b-a)(c-a)\]</span></p>
<p><span class="math display">\[\gamma_2 = (b-a)(c-b)\]</span></p>
<p>Continuing:</p>
<p><span class="math display">\[E(X_{(r)}) = \int_a^c
\frac{\gamma_0}{\gamma_1^n} x(x-a)^{2r-1} \left(\gamma_1 -
(x-a)^2\right)^{n-r}dx + \int_c^b \frac{\gamma_0}{\gamma_2^n}
(-1)^{n-r}x(x-b)^{2n-2r+1} \left(\gamma_2 +
(x-b)^2\right)^{r-1}dx\]</span></p>
<p>By using a binomial expansion, we can prevent having to integrate by
parts multiple times.</p>
<p><span class="math display">\[(a+b)^n = \sum_{k=0}^n {n \choose k}
a^kb^{n-k}\]</span></p>
<p><span class="math display">\[
\begin{align}
E(X_{(r)}) &amp;= \int_a^c \frac{\gamma_0}{\gamma_1^n} x(x-a)^{2r-1}
\sum_{k=0}^{n-r} {n-r \choose k} \gamma_1^k
(-1)^{n-r-k}(x-a)^{2n-2r-2k}dx \\
&amp;+ \int_c^b \frac{\gamma_0}{\gamma_2^n} (-1)^{n-r}x(x-b)^{2n-2r+1}
\sum_{k=0}^{r-1} {r-1 \choose k} \gamma_2^k (x-b)^{2r-2-2k}dx
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
E(X_{(r)}) &amp;= \frac{\gamma_0}{\gamma_1^n} \sum_{k=0}^{n-r}   {n-r
\choose k} \gamma_1^k (-1)^{n-r-k}\int_a^c x(x-a)^{2n-2k-1}dx \\
&amp;+ \frac{\gamma_0}{\gamma_2^n} (-1)^{(n-r)} \sum_{k=0}^{r-1} {r-1
\choose k} \gamma_2^k \int_c^b x(x-b)^{2n-2k-1}dx
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
E(X_{(r)}) &amp;= \gamma_0 \sum_{k=0}^{n-r}   {n-r \choose k}
\gamma_1^{k-n} (-1)^{n-r-k} \left[\frac{c(c-a)^{2n-2k}}{2n-2k} -
\frac{(c-a)^{2n-2k+1}}{(2n-2k)(2n-2k+1)}\right] \\
&amp;+ \gamma_0 (-1)^{n-r} \sum_{k=0}^{r-1} {r-1 \choose k}
\gamma_2^{k-n}  \left[\frac{-c(c-b)^{2n-2k}}{2n-2k}+\frac{(c-b)^{2n-2k+1}}{(2n-2k)(2n-2k+1)}\right]
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
E(X_{(r)}) &amp;= r {n \choose r} \sum_{k=0}^{n-r}   {n-r \choose k}
(b-a)^{k-n} (c-a)^{n-k} (-1)^{n-r-k} \left[\frac{c}{n-k} -
\frac{c-a}{(n-k)(2n-2k+1)}\right] \\
&amp;+ r {n \choose r} (-1)^{n-r} \sum_{k=0}^{r-1} {r-1 \choose k}
(b-a)^{k-n} (c-b)^{n-k}
\left[\frac{-c}{n-k}+\frac{c-b}{(n-k)(2n-2k+1)}\right]
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
E(X_{(r)}) &amp;= r {n \choose r}  \bigg[ \ \sum_{k=0}^{n-r}   {n-r
\choose k} (b-a)^{k-n} (c-a)^{n-k} (-1)^{n-r-k}
\frac{2c(n-k)+a}{(n-k)(2(n-k) + 1)} \\
&amp;+ (-1)^{n-r+1} \sum_{k=0}^{r-1} {r-1 \choose k} (b-a)^{k-n}
(c-b)^{n-k} \frac{2c(n-k)+b}{(n-k)(2(n-k)+1)} \ \bigg]
\end{align}
\]</span></p>
</div>
<div class="section level4">
<h4 id="expected-value-of-rth-order-statistic-squared">Expected Value of <span class="math inline">\(r^{th}\)</span> order
statistic squared<a class="anchor" aria-label="anchor" href="#expected-value-of-rth-order-statistic-squared"></a>
</h4>
<p>Continuing from the above derivation:</p>
<p><span class="math display">\[
\begin{align}
E(X_{(r)}^2) &amp;= \frac{\gamma_0}{\gamma_1^n} \sum_{k=0}^{n-r}   {n-r
\choose k} \gamma_1^k (-1)^{n-r-k}\int_a^c x^2(x-a)^{2n-2k-1}dx \\
&amp;+ \frac{\gamma_0}{\gamma_2^n} (-1)^{(n-r)} \sum_{k=0}^{r-1} {r-1
\choose k} \gamma_2^k \int_c^b x^2(x-b)^{2n-2k-1}dx
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
E(X_{(r)}^2) &amp;= \gamma_0 \sum_{k=0}^{n-r}   {n-r \choose k}
\gamma_1^{k-n} (-1)^{n-r-k} \frac{(c-a)^{2n-2k}}{2n-2k}\left[c^2 -
\frac{2c(c-a)}{2n-2k+1} + \frac{2(c-a)^2}{(2n-2k+1)(2n-2k+2)}\right] \\
&amp;+ \gamma_0 (-1)^{(n-r)} \sum_{k=0}^{r-1} {r-1 \choose k}
\gamma_2^{k-n}  \frac{(c-b)^{2n-2k}}{2n-2k}\left[-c^2 +
\frac{2c(c-b)}{2n-2k+1}-\frac{2(c-b)^2}{(2n-2k+1)(2n-2k+2)}\right]
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
E(X_{(r)}^2) &amp;= r {n \choose r} \sum_{k=0}^{n-r}   {n-r \choose k}
(b-a)^{k-n} (c-a)^{n-k} (-1)^{n-r-k} \frac{1}{n-k}\left[c^2 -
\frac{2c(c-a)}{2n-2k+1} + \frac{2(c-a)^2}{(2n-2k+1)(2n-2k+2)}\right] \\
&amp;+ r {n \choose r} (-1)^{(n-r)} \sum_{k=0}^{r-1} {r-1 \choose k}
(b-a)^{k-n} (c-b)^{n-k} \frac{1}{n-k}\left[-c^2 +
\frac{2c(c-b)}{2n-2k+1}-\frac{2(c-b)^2}{(2n-2k+1)(2n-2k+2)}\right]
\end{align}
\]</span></p>
</div>
<div class="section level4">
<h4 id="variance-of-the-rth-order-statistic">Variance of the <span class="math inline">\(r^{th}\)</span> order
statistic<a class="anchor" aria-label="anchor" href="#variance-of-the-rth-order-statistic"></a>
</h4>
<p><span class="math display">\[V\left(X_{(r)}\right) = E(X_{(r)}^2) -
\left[E(X_{(r)})\right]^2\]</span></p>
</div>
<div class="section level4">
<h4 id="numerical-stability-of-variance-and-expected-value-of-rth-order-statistic">Numerical Stability of Variance and Expected value of <span class="math inline">\(r^{th}\)</span> order statistic<a class="anchor" aria-label="anchor" href="#numerical-stability-of-variance-and-expected-value-of-rth-order-statistic"></a>
</h4>
<p>Although the above derivation gives an exact solution to the variance
and expected value of the <span class="math inline">\(r^{th}\)</span>
order statistic of the triangle distribution, the alternative sign
inside the binomial sum and the large orders of magnitude over which
those coefficients span lead to cancellation errors in the results that
are not easy to solve. Exact solutions can be obtained to arbitrary
precision through the use a package like <code>Rmpfr</code>. The
<code>triangle</code> package defaults to the use of numerical
integration for these results.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rob Carnell.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
